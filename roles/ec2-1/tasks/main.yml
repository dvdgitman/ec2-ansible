---
# tasks file for ec2-1
- name: Make Sure pip3 Is Installed
  become: yes
  apt:
    update_cache: yes
    name: python3-pip
    state: present


- name: Make Sure Docker py Is Installed
  pip:
    name: docker-py
    state: present

- name: Make Sure Docker Is Installed
  become: yes
  apt:
    name: docker.io
    state: present
    update_cache: yes


- name: Start Docker Service
  become: yes
  service:
    name: docker
    state: started

- name: Clone Git Repository
  git:
    repo: https://github.com/dvdgitman/ip-geolocation-locator
    dest: /home/ubuntu/ip/iplocation

- name: Log into DockerHub
  docker_login:
    username: davidgman2
    password: 123456789

- name: Build an image and push to docker hub
  docker_image:
    build:
      path: /home/ubuntu/ip/iplocation:1.1
    name: ip
    repository: davidgman2/ip
    tag: v1
    source: build